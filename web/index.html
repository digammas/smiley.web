<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Smiley Home Page</title>
</head>
<body>
<h1>Smiley Web</h1>
<div id="login" style="display: none">
<input type="text" id="name" /><button onclick="login();">Login</button>
</div>
<div id=user style="display: none">Welcome <span id="greeting"></span> |
<a href="#" onclick="logout();">logout</a>
</div>

<ul>
	<li><a href='substitution.html'>Substitution service</a></li>
	<li><a href='list'>List all smileys</a></li>
	<li><a href='index.html'>Back to home page</a></li>
</ul>

<script>
var loginElement = document.querySelector("#login");
var userElement = document.querySelector("#user");
var greetingElement = document.querySelector("#greeting");

function doOnLoad() {
	if (this.status == 200) {
		loginElement.style.display = "none";
		userElement.style.display = "block";
		greetingElement.innerHTML = this.responseText;
	} else {
		greetingElement.innerHTML = "";
		loginElement.style.display = "block";
		userElement.style.display = "none";
	}
}

var xhr = new XMLHttpRequest();
xhr.open("GET", "rest/user");
xhr.onload = doOnLoad;
xhr.send();

function login() {
	var xhr = new XMLHttpRequest();
	var user = document.querySelector("#name").value;
	xhr.open("POST", "rest/user");
	xhr.onload = doOnLoad;
	xhr.send(user);
}

function logout() {
	var xhr = new XMLHttpRequest();
	var user = document.querySelector("#name").value;
	xhr.open("DELETE", "rest/user");
	xhr.onload = doOnLoad;
	xhr.send();
}
</script>
</body>
</html>